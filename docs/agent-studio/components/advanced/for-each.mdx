---
title: ForEach Component
description: Loop over arrays in SmythOS to run steps per item, transform data, and return one aggregated result.
keywords: ["ForEach", "For Each", "loop array", "iterate list", "batch processing", "map transform", "workflow automation", "aggregate results", "SmythOS", "AI workflows"]
---

# For Each Component

**For Each** runs a set of steps for every item in an array, then returns one aggregated result. Use it to process batch data, transform lists, or run repeatable tasks in sequence.

<InfoCallout title="Why This Matters">
Manually processing lists is tedious and not scalable.  **For Each** automates the repetition so workflows stay simple and reliable, whether the list has 3 items or 3,000.
</InfoCallout>

<Arcade src="https://demo.arcade.software/712A7jqiMFGqgWkutOCL?embed&embed_mobile=tab&embed_desktop=inline&show_copy_link=true" title="For Each | SmythOS" />

<Spacer size="md" />

## Step 1: Provide the Input Array

The component expects a single input: a JSON array.

| Input | Required? | Description | Notes |
|---|---|---|---|
| **Array** | <Badge type="required">Yes</Badge> | Items to process one by one | Must be a valid JSON array such as `[1,2,3]`, `["a","b"]`, or an array of objects |

<TipCallout title="Dynamic Sources">
Pass arrays from **API Call**, **Code**, **Database**, or any previous step that returns a list.
</TipCallout>

<Spacer size="md" />

## Step 2: Build the Loop Steps

Inside **For Each**, add the components that should run for each item. Two loop variables are available:

| Variable | Description |
|---|---|
| **item** | The current list value such as `"alice"` or `{ "id": 42, "email": "a@b.com" }` |
| **index** | Position of the current item starting at 0 |

Use `{{item}}` and `{{index}}` as inputs to components inside the loop.  
For objects, access fields like `{{item.email}}` or `{{item.id}}`.

**Example input**

```json
[
  { "id": 101, "email": "a@example.com" },
  { "id": 102, "email": "b@example.com" }
]
```
**Example use inside the loop**

- API path: `/users/{{item.id}}`
- Email field to validate: `{{item.email}}`

## Step 3: Choose the Output Format

This controls the structure of the final `Result` after all iterations finish.

<Tabs
  tabs={[
    {
      label: 'Full',
      content: (
        <>
          <p><strong>Full</strong> returns an object per iteration with <code>index</code>, <code>item</code>, and the full output of the last step inside the loop.</p>
          <p>Good for debugging and audits.</p>
          <pre>
            <code className="language-json">
              {[
                '[',
                '  { "index": 0, "item": "apple", "result": { "status": 200, "value": "processed_apple" } },',
                '  { "index": 1, "item": "banana", "result": { "status": 200, "value": "processed_banana" } }',
                ']'
              ].join('\n')}
            </code>
          </pre>
        </>
      )
    },
    {
      label: 'Minimal',
      content: (
        <>
          <p><strong>Minimal</strong> returns an object per iteration with just <code>index</code> and the last step’s direct output.</p>
          <p>Good when the original item is not needed downstream.</p>
          <pre>
            <code className="language-json">
              {[
                '[',
                '  { "index": 0, "result": "processed_apple" },',
                '  { "index": 1, "result": "processed_banana" }',
                ']'
              ].join('\n')}
            </code>
          </pre>
        </>
      )
    },
    {
      label: 'Array Only',
      content: (
        <>
          <p><strong>Array Only</strong> returns a simple array of the last step’s output for each iteration.</p>
          <p>Best for classic map or transform operations.</p>
          <pre>
            <code className="language-json">
              {[
                '[',
                '  "processed_apple",',
                '  "processed_banana"',
                ']'
              ].join('\n')}
            </code>
          </pre>
        </>
      )
    }
  ]}
/>


<Spacer size="md" />

## Step 4: Use the Aggregated Result

**For Each** exposes one output after the loop completes.

| Output | Description | Data Shape |
|---|---|---|
| **Result** | All collected outcomes from the loop | Depends on the selected Output Format |

**End to end example**

**Input**

```json
[
  "Ada Lovelace",
  "Alan Turing"
] 
```

**Loop step inside For Each**

- LLM prompt: `Summarise "{{item}}" in one sentence.`

**Output with Array Only**

```json
[
  "Ada Lovelace pioneered early computing concepts.",
  "Alan Turing shaped modern computer science and cryptography."
] 
```

<TipCallout title="Send Results Forward">
Connect **Result** to downstream steps such as **Code**, **RAG Remember**, or another **For Each**.
</TipCallout>

<Spacer size="md" />

## Best Practices

- **Keep Loop Steps Focused**  
  Use small, single-purpose steps inside the loop. Move heavy logic to a reusable **Agent Skill** or **Code** step.
- **Guard Against Empty Lists**  
  Add a **Condition** before **For Each** to skip execution when the array is empty.
- **Mind API Limits**  
  If calling external APIs, consider rate limits. Add retries or spacing where needed.
- **Choose the Right Output**  
  Use **Array Only** for transforms, **Minimal** for light tracking, **Full** for traceability and audits.

<Spacer size="md" />

## Troubleshooting

<InfoCallout title="Common Causes and Fixes">
- **Not an array**  
  Ensure the input is a valid JSON array. Log it with **Code** if unsure.
- **Wrong field path**  
  Verify object access such as `{{item.email}}` matches the actual input.
- **Unexpected Result shape**  
  Remember the final value comes from the last step inside the loop. Confirm that step outputs what you need.
- **Nothing returned**  
  Check that the loop ran at least once and the array was not empty.
</InfoCallout>

<Spacer size="md" />

## What To Try Next

- Enrich each item with an **[API Call](/docs/agent-studio/components/advanced/api-call)** and return only the needed fields with **Array Only**.
- Pipe the **Result** into **[GenAI LLM](/docs/agent-studio/components/base/gen-ai-llm)** to summarise the list in one paragraph.
- Chain a second **For Each** to post process only the items that met a condition in the first pass.